name: Update YAML in another repo

on:
  push:
    branches:
      - main # aqu√≠ pones las ramas donde quieres que corras
      - develop
jobs:
  update-yaml:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout current repo
        uses: actions/checkout@v4

      - name: Debug token
        run: |
          echo "Token length: ${#STATE_FILES_TOKEN}"
          echo "First 4 chars: ${STATE_FILES_TOKEN:0:4}"
        env:
          STATE_FILES_TOKEN: ${{ secrets.STATE_FILES_TOKEN }}

      - name: List actions folder
        run: ls -R .github/actions/state-file

      - name: Run custom update action
        uses: ./.github/actions/state-file
        with:
          repo: QUIDA5V/state-files-repo
          branch: main
          file_path: state-files-repo/dev/non-cde/kustomization.yaml # el archivo a actualizar
          image_name: myimage
          image_tag: 1.26.1
          github_token: ${{ secrets.STATE_FILES_TOKEN }}
